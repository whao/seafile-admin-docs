
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="seafile">
      
      
        <link rel="canonical" href="https://haiwen.github.io/seafile-admin-docs/upgrade/upgrade_notes_for_9.0.x/">
      
      <link rel="icon" href="../../media/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Upgrade notes for 9.0.x - Seafile Admin Manual</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#upgrade-notes-for-90" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Seafile Admin Manual" class="md-header__button md-logo" aria-label="Seafile Admin Manual" data-md-component="logo">
      
  <img src="../../media/seafile-transparent-1024.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Seafile Admin Manual
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Upgrade notes for 9.0.x
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/haiwen/seafile-admin-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    haiwen/seafile-admin-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Seafile Admin Manual" class="md-nav__button md-logo" aria-label="Seafile Admin Manual" data-md-component="logo">
      
  <img src="../../media/seafile-transparent-1024.png" alt="logo">

    </a>
    Seafile Admin Manual
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/haiwen/seafile-admin-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    haiwen/seafile-admin-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Overview" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/components/" class="md-nav__link">
        Seafile Components
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/file_permission_management/" class="md-nav__link">
        File permission management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contribution/" class="md-nav__link">
        Contribution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Seafile Community Setup on Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Seafile Community Setup on Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Seafile Community Setup on Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/" class="md-nav__link">
        Outline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/using_sqlite/" class="md-nav__link">
        Installation with SQLite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/using_mysql/" class="md-nav__link">
        Installation with MySQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/https_with_nginx/" class="md-nav__link">
        HTTPS with Nginx
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/https_with_apache/" class="md-nav__link">
        HTTPS with Apache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/using_ldap/" class="md-nav__link">
        LDAP/AD Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" type="checkbox" id="__nav_2_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_7">
          Single Sign On
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Single Sign On" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          Single Sign On
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/single_sign_on/" class="md-nav__link">
        Outline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/shibboleth_config_v6.3/" class="md-nav__link">
        Shibboleth Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/oauth/" class="md-nav__link">
        OAuth Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/remote_user/" class="md-nav__link">
        Remote User Authentication
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/using_syslog/" class="md-nav__link">
        Syslog Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_9" type="checkbox" id="__nav_2_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_9">
          Online File Preview and Edit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Online File Preview and Edit" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_9">
          <span class="md-nav__icon md-icon"></span>
          Online File Preview and Edit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/libreoffice_online/" class="md-nav__link">
        LibreOffice Online Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/only_office/" class="md-nav__link">
        OnlyOffice Integration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/ocm/" class="md-nav__link">
        Open Cloud Mesh
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_11" type="checkbox" id="__nav_2_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_11">
          Other Deployment Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other Deployment Notes" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_11">
          <span class="md-nav__icon md-icon"></span>
          Other Deployment Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/start_seafile_at_system_bootup/" class="md-nav__link">
        Start Seafile at System Bootup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/using_firewall/" class="md-nav__link">
        Firewall settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/using_logrotate/" class="md-nav__link">
        Logrotate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/add_memcached/" class="md-nav__link">
        Add Memcached
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/deploy_seafile_behind_nat/" class="md-nav__link">
        Deploy Seafile behind NAT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/deploy_seahub_at_non-root_domain/" class="md-nav__link">
        Deploy Seahub at Non-root domain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/migrate_from_sqlite_to_mysql/" class="md-nav__link">
        Migrate From SQLite to MySQL
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        Common Problems for Setting up Server
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Seafile Professional Setup on Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Seafile Professional Setup on Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Seafile Professional Setup on Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/" class="md-nav__link">
        Outline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/download_and_setup_seafile_professional_server/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/migrate_from_seafile_community_server/" class="md-nav__link">
        Migration from Seafile Community
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4">
          LDAP/AD Integration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="LDAP/AD Integration" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          LDAP/AD Integration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/using_ldap_pro/" class="md-nav__link">
        LDAP Configuration for Seafile Pro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/ldap_group_sync/" class="md-nav__link">
        Importing Groups from LDAP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/ldap_role_sync/" class="md-nav__link">
        Importing Roles from LDAP
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_5" type="checkbox" id="__nav_3_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_5">
          Online File Preview and Edit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Online File Preview and Edit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Online File Preview and Edit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/office_documents_preview/" class="md-nav__link">
        Office Documents Preview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/office_web_app/" class="md-nav__link">
        Office Online Server Integration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/details_about_file_search/" class="md-nav__link">
        File Search
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_7" type="checkbox" id="__nav_3_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_7">
          Virus Scan
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Virus Scan" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Virus Scan
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/virus_scan/" class="md-nav__link">
        Outline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/deploy_clamav_as_daemon/" class="md-nav__link">
        Run ClamAV as a Daemon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/virus_scan_with_kav4fs/" class="md-nav__link">
        Virus Scan With Kav4fs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_8" type="checkbox" id="__nav_3_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_8">
          Storage Backends
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Storage Backends" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          Storage Backends
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/setup_with_amazon_s3/" class="md-nav__link">
        Amazon S3 Backend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/setup_with_ceph/" class="md-nav__link">
        Ceph Backend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/setup_with_swift/" class="md-nav__link">
        OpenStack Swift Backend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/multiple_storage_backends/" class="md-nav__link">
        Multiple Storage Backends
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/migrate/" class="md-nav__link">
        Data migration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_9" type="checkbox" id="__nav_3_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_9">
          Cluster Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cluster Deployment" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_9">
          <span class="md-nav__icon md-icon"></span>
          Cluster Deployment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/deploy_in_a_cluster/" class="md-nav__link">
        Deploy in a cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/enable_search_and_background_tasks_in_a_cluster/" class="md-nav__link">
        Search and background tasks in a cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/memcached_mariadb_cluster/" class="md-nav__link">
        Memcache and MariaDB Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/setup_seafile_cluster_with_nfs/" class="md-nav__link">
        Setup Seafile cluster with NFS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/upgrade_a_cluster/" class="md-nav__link">
        Upgrade a cluster
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_10" type="checkbox" id="__nav_3_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_10">
          Advanced User Management
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced User Management" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_10">
          <span class="md-nav__icon md-icon"></span>
          Advanced User Management
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/multi_institutions/" class="md-nav__link">
        Multi-Institutions Support
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/roles_permissions/" class="md-nav__link">
        Roles and Permissions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/admin_roles_permissions/" class="md-nav__link">
        Administrator Roles and Permissions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/multi_tenancy/" class="md-nav__link">
        Multi-Tenancy Support
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11" type="checkbox" id="__nav_3_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_11">
          Advanced Authentication
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced Authentication" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_11">
          <span class="md-nav__icon md-icon"></span>
          Advanced Authentication
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/two_factor_authentication/" class="md-nav__link">
        Two-factor Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/adfs/" class="md-nav__link">
        ADFS or SAML 2.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/cas/" class="md-nav__link">
        CAS Authentication
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_12" type="checkbox" id="__nav_3_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_12">
          Advanced Maintenance Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced Maintenance Tools" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_12">
          <span class="md-nav__icon md-icon"></span>
          Advanced Maintenance Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/real_time_backup/" class="md-nav__link">
        Real-time Backup Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/seaf_import/" class="md-nav__link">
        Import Directory To Seafile
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/memcached_options/" class="md-nav__link">
        Memcached Options for Pro Edition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy_pro/seafile_professional_sdition_software_license_agreement/" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Seafile Setup with Docker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Seafile Setup with Docker" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Seafile Setup with Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/deploy_seafile_with_docker/" class="md-nav__link">
        Seafile Community Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/pro-edition/deploy_seafile_pro_with_docker/" class="md-nav__link">
        Seafile Professional Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/cluster/deploy_seafile_cluster_with_docker/" class="md-nav__link">
        Seafile Docker Cluster Deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/pro-edition/migrate_ce_to_pro_with_docker/" class="md-nav__link">
        Migration from Seafile Community
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/non_docker_to_docker/" class="md-nav__link">
        Migrate from non-docker deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_6" type="checkbox" id="__nav_4_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_6">
          Upgrade from 6.3 to 7.0
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Upgrade from 6.3 to 7.0" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Upgrade from 6.3 to 7.0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/6.3_upgrade_to_7.0/" class="md-nav__link">
        Upgrade Seafile Docker CE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/pro-edition/6.3_upgrade_to_7.0/" class="md-nav__link">
        Upgrade Seafile Docker Pro
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/upgrade/upgrade_docker/" class="md-nav__link">
        Upgrade for other versions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Configuration and Customization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration and Customization" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Configuration and Customization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        Outline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/ccnet-conf/" class="md-nav__link">
        ccnet.conf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/seafile-conf/" class="md-nav__link">
        seafile.conf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/seahub_settings_py/" class="md-nav__link">
        seahub_settings.py
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/seafevents-conf/" class="md-nav__link">
        seafevents.conf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/seahub_customization/" class="md-nav__link">
        Seahub customization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/sending_email/" class="md-nav__link">
        Email Sending
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Administration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Administration" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Administration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../maintain/" class="md-nav__link">
        Outline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../maintain/account/" class="md-nav__link">
        Account management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../maintain/logs/" class="md-nav__link">
        Logs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../maintain/backup_recovery/" class="md-nav__link">
        Backup and Recovery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../maintain/seafile_fsck/" class="md-nav__link">
        Seafile FSCK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../maintain/seafile_gc/" class="md-nav__link">
        Seafile GC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../maintain/clean_database/" class="md-nav__link">
        Clean database
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../maintain/export_report/" class="md-nav__link">
        Export report
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Upgrade Seafile Server
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Upgrade Seafile Server" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Upgrade Seafile Server
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../upgrade/" class="md-nav__link">
        Outline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../upgrade_notes_for_6.x.x/" class="md-nav__link">
        Upgrade notes for 6.x.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../upgrade_notes_for_7.0.x/" class="md-nav__link">
        Upgrade notes for 7.0.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../upgrade_notes_for_7.1.x/" class="md-nav__link">
        Upgrade notes for 7.1.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../upgrade_notes_for_8.0.x/" class="md-nav__link">
        Upgrade notes for 8.0.x
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Upgrade notes for 9.0.x
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Upgrade notes for 9.0.x
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important-release-changes" class="md-nav__link">
    Important release changes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#new-python-libraries" class="md-nav__link">
    New Python libraries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrade-to-90x" class="md-nav__link">
    Upgrade to 9.0.x
  </a>
  
    <nav class="md-nav" aria-label="Upgrade to 9.0.x">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-elasticsearch-pro-edition-only" class="md-nav__link">
    Update ElasticSearch (pro edition only)
  </a>
  
    <nav class="md-nav" aria-label="Update ElasticSearch (pro edition only)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-one-rebuild-the-index-and-discard-the-old-index-data" class="md-nav__link">
    Method one, rebuild the index and discard the old index data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-two-reindex-the-existing-data" class="md-nav__link">
    Method two, reindex the existing data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-three-if-you-are-in-a-cluster-environment" class="md-nav__link">
    Method three, if you are in a cluster environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          WebDAV and FUSE extensions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="WebDAV and FUSE extensions" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          WebDAV and FUSE extensions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/" class="md-nav__link">
        Outline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/webdav/" class="md-nav__link">
        WebDAV extension
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/fuse/" class="md-nav__link">
        FUSE extension
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Security and Auditing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Security and Auditing" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Security and Auditing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/security_features/" class="md-nav__link">
        Security features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/auditing/" class="md-nav__link">
        Access logs and auditing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/fail2ban/" class="md-nav__link">
        Config fail2ban
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Developing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developing" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Developing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/" class="md-nav__link">
        Outline
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2" type="checkbox" id="__nav_10_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2">
          How to Build Seafile
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How to Build Seafile" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_2">
          <span class="md-nav__icon md-icon"></span>
          How to Build Seafile
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../build_seafile/" class="md-nav__link">
        Outline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../build_seafile/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../build_seafile/freebsd/" class="md-nav__link">
        FreeBSD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../build_seafile/osx/" class="md-nav__link">
        Mac OS X
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../build_seafile/windows/" class="md-nav__link">
        Windows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../build_seafile/server/" class="md-nav__link">
        Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../build_seafile/rpi/" class="md-nav__link">
        Raspberry Pi
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/env/" class="md-nav__link">
        Develop env
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/translation/" class="md-nav__link">
        Translation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/web_api_v2.1/" class="md-nav__link">
        Web API V2.1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/python_api/" class="md-nav__link">
        Python API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/rene-s/Seafile-PHP-SDK" class="md-nav__link">
        PHP API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/data_model/" class="md-nav__link">
        Data Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/server-components/" class="md-nav__link">
        Server Components
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          ChangeLog
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ChangeLog" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          ChangeLog
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/server-changelog/" class="md-nav__link">
        Seafile Community Edition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/changelog-for-seafile-professional-server/" class="md-nav__link">
        Seafile Professional Edition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/client-changelog/" class="md-nav__link">
        Seafile Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/drive-client-changelog/" class="md-nav__link">
        Drive Client
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important-release-changes" class="md-nav__link">
    Important release changes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#new-python-libraries" class="md-nav__link">
    New Python libraries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrade-to-90x" class="md-nav__link">
    Upgrade to 9.0.x
  </a>
  
    <nav class="md-nav" aria-label="Upgrade to 9.0.x">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-elasticsearch-pro-edition-only" class="md-nav__link">
    Update ElasticSearch (pro edition only)
  </a>
  
    <nav class="md-nav" aria-label="Update ElasticSearch (pro edition only)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-one-rebuild-the-index-and-discard-the-old-index-data" class="md-nav__link">
    Method one, rebuild the index and discard the old index data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-two-reindex-the-existing-data" class="md-nav__link">
    Method two, reindex the existing data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-three-if-you-are-in-a-cluster-environment" class="md-nav__link">
    Method three, if you are in a cluster environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/haiwen/seafile-admin-docs/blob/master/manual/upgrade/upgrade_notes_for_9.0.x.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="upgrade-notes-for-90">Upgrade notes for 9.0<a class="headerlink" href="#upgrade-notes-for-90" title="Permanent link">&para;</a></h1>
<p>These notes give additional information about changes.
Please always follow the main <a href="../upgrade/">upgrade guide</a>.</p>
<h2 id="important-release-changes">Important release changes<a class="headerlink" href="#important-release-changes" title="Permanent link">&para;</a></h2>
<p>9.0 version includes following major changes:</p>
<ol>
<li>SERVICE_URL is moved from ccnet.conf to seahub_settings.py. The upgrade script will read it from ccnet.conf and write to seahub_settings.py</li>
<li>(pro edition only) ElasticSearch is upgraded to version 6.8. ElasticSearch needs to be installed and managed individually. (As ElasticSearch changes license since 6.2, it can no longer be included in Seafile package). There are some benefits for ElasticSearch to be managed individually:<ul>
<li>Reduce the size of Seafile package</li>
<li>You can change ElasticSearch setttings more easily</li>
</ul>
</li>
<li>(pro ediiton only) The built-in Office file preview is now implemented by a separate docker image. This makes is more easy to maintain. We also suggest users to use OnlyOffice as an alternative.</li>
<li>Seafile community edition package for CentOS is no longer maintained (pro editions will still be maintaied). We suggest users to migrate to Docker images.</li>
<li>We rewrite HTTP service in seaf-server with golang and move it to a separate component (turn off by default)</li>
</ol>
<p>The new file-server written in golang serves HTTP requests to upload/download/sync files. It provides three advantages:</p>
<ul>
<li>The performance is better in a high-concurrency environment and it can handle long requests.</li>
<li>Now you can sync libraries with large number of files.</li>
<li>Now file zipping and downloading can be done simutaneously. When zip downloading a folder, you don't need to wait until zip is done.</li>
<li>Support rate control for file uploading and downloading.</li>
</ul>
<p>You can turn golang file-server on by adding following configuration in seafile.conf</p>
<div class="codehilite"><pre><span></span><code><span class="k">[fileserver]</span><span class="w"></span>
<span class="na">use_go_fileserver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span><span class="w"></span>
</code></pre></div>

<h2 id="new-python-libraries">New Python libraries<a class="headerlink" href="#new-python-libraries" title="Permanent link">&para;</a></h2>
<p>Note, you should install Python libraries system wide using root user or sudo mode.</p>
<ul>
<li>For Ubuntu 18.04/20.04</li>
</ul>
<div class="codehilite"><pre><span></span><code>sudo pip3 install <span class="nv">pycryptodome</span><span class="o">==</span><span class="m">3</span>.12.0 <span class="nv">cffi</span><span class="o">==</span><span class="m">1</span>.14.0
</code></pre></div>

<h2 id="upgrade-to-90x">Upgrade to 9.0.x<a class="headerlink" href="#upgrade-to-90x" title="Permanent link">&para;</a></h2>
<ol>
<li>Stop Seafile-8.0.x server.</li>
<li>
<p>Start from Seafile 9.0.x, run the script:</p>
<p><code>sh
upgrade/upgrade_8.0_9.0.sh</code></p>
</li>
<li>
<p>Start Seafile-9.0.x server.</p>
</li>
</ol>
<h3 id="update-elasticsearch-pro-edition-only">Update ElasticSearch (pro edition only)<a class="headerlink" href="#update-elasticsearch-pro-edition-only" title="Permanent link">&para;</a></h3>
<h4 id="method-one-rebuild-the-index-and-discard-the-old-index-data">Method one, rebuild the index and discard the old index data<a class="headerlink" href="#method-one-rebuild-the-index-and-discard-the-old-index-data" title="Permanent link">&para;</a></h4>
<p>If your elasticsearch data is not large, it is recommended to deploy the latest 7.x version of ElasticSearch and then rebuild the new index. Specific steps are as follows</p>
<p>Download ElasticSearch image</p>
<div class="codehilite"><pre><span></span><code>docker pull elasticsearch:7.16.2
</code></pre></div>

<p>Create a new folder to store ES data and give the folder permissions</p>
<div class="codehilite"><pre><span></span><code>mkdir -p /opt/seafile-elasticsearch/data  &amp;&amp; chmod -R 777 /opt/seafile-elasticsearch/data/
</code></pre></div>

<p>Start ES docker image</p>
<div class="codehilite"><pre><span></span><code>docker run -d \
--name es \
-p 9200:9200 \
-e &quot;discovery.type=single-node&quot; -e &quot;bootstrap.memory_lock=true&quot; \
-e &quot;ES_JAVA_OPTS=-Xms1g -Xmx1g&quot; -e &quot;xpack.security.enabled=false&quot; \
--restart=always \
-v /opt/seafile-elasticsearch/data:/usr/share/elasticsearch/data \
-d elasticsearch:7.16.2
</code></pre></div>

<p>Delete old index data</p>
<div class="codehilite"><pre><span></span><code>rm -rf /opt/seafile/pro-data/search/data/*
</code></pre></div>

<p>Modify seafevents.conf</p>
<div class="codehilite"><pre><span></span><code><span class="k">[INDEX FILES]</span><span class="w"></span>
<span class="na">external_es_server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span><span class="w"></span>
<span class="na">es_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">your server&#39;s IP</span><span class="w"></span>
<span class="na">es_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">9200</span><span class="w"></span>
</code></pre></div>

<p>Restart seafile</p>
<div class="codehilite"><pre><span></span><code>su seafile
cd seafile-server-latest/
./seafile.sh stop &amp;&amp; ./seahub.stop 
./seafile.sh start &amp;&amp; ./seahub.start 
</code></pre></div>

<h4 id="method-two-reindex-the-existing-data">Method two, reindex the existing data<a class="headerlink" href="#method-two-reindex-the-existing-data" title="Permanent link">&para;</a></h4>
<p>If your data volume is relatively large, it will take a long time to rebuild indexes for all Seafile databases, so you can reindex the existing data. This requires the following steps</p>
<ul>
<li>Download and start ElasticSearch 6.8.20</li>
<li>Use the existing data to execute ElasticSearch Reindex in order to build an index that can be used in 7.x</li>
<li>Download and start ElasticSearch 7.x</li>
</ul>
<p>The detailed process is as follows</p>
<p>Download ElasticSearch image:</p>
<div class="codehilite"><pre><span></span><code>docker pull elasticsearch:6.8.20
</code></pre></div>

<p>PS：For seafile version 9.0, you need to manually create the elasticsearch mapping path on the host machine and give it 777 permission, otherwise elasticsearch will report path permission problems when starting, the command is as follows  </p>
<div class="codehilite"><pre><span></span><code>mkdir -p /opt/seafile-elasticsearch/data 
</code></pre></div>

<p>Move original data to the new folder and give the folder permissions</p>
<div class="codehilite"><pre><span></span><code>mv  /opt/seafile/pro-data/search/data/*  /opt/seafile-elasticsearch/data/
chmod -R 777 /opt/seafile-elasticsearch/data/
</code></pre></div>

<p>Start ES docker image</p>
<div class="codehilite"><pre><span></span><code>docker run -d --name es -p 9200:9200  -e &quot;discovery.type=single-node&quot; -e &quot;bootstrap.memory_lock=true&quot; -e &quot;ES_JAVA_OPTS=-Xms1g -Xmx1g&quot; --restart=always -v /opt/seafile-elasticsearch/data:/usr/share/elasticsearch/data -d elasticsearch:6.8.20
</code></pre></div>

<p>Note:<code>ES_JAVA_OPTS</code> can be adjusted according to your need.</p>
<p>Create an index with 7.x compatible mappings.</p>
<div class="codehilite"><pre><span></span><code>curl <span class="err">-</span>X PUT <span class="err">-</span>H <span class="err">&#39;</span>Content-Type<span class="p">:</span> <span class="l">application/json</span><span class="err">&#39;</span> <span class="err">&#39;</span>http<span class="p">{</span>s<span class="p">}:</span><span class="o">//</span><span class="p">{</span>es server IP<span class="p">}:</span><span class="mi">9200</span><span class="l">/new_repo_head</span><span class="o">?</span><span class="ss">include_type_name=</span><span class="no">false</span><span class="err">&amp;</span><span class="ss">pretty=</span><span class="no">true</span><span class="err">&#39;</span> <span class="err">-</span>d <span class="err">&#39;</span>
<span class="p">{</span>
  <span class="s2">&quot;mappings&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;properties&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;commit&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="no">false</span>
      <span class="p">},</span>
      <span class="s2">&quot;repo&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="no">false</span>
      <span class="p">},</span>
      <span class="s2">&quot;updatingto&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="no">false</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span><span class="err">&#39;</span>

curl <span class="err">-</span>X PUT <span class="err">-</span>H <span class="err">&#39;</span>Content-Type<span class="p">:</span> <span class="l">application/json</span><span class="err">&#39;</span> <span class="err">&#39;</span>http<span class="p">{</span>s<span class="p">}:</span><span class="o">//</span><span class="p">{</span>es server IP<span class="p">}:</span><span class="mi">9200</span><span class="l">/new_repofiles</span><span class="err">/</span><span class="o">?</span><span class="ss">include_type_name=</span><span class="no">false</span><span class="err">&amp;</span><span class="ss">pretty=</span><span class="no">true</span><span class="err">&#39;</span> <span class="err">-</span>d <span class="err">&#39;</span>
<span class="p">{</span>
  <span class="s2">&quot;settings&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;analysis&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;analyzer&quot;</span> <span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;seafile_file_name_ngram_analyzer&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;filter&quot;</span> <span class="p">:</span> <span class="p">[</span>
              <span class="s2">&quot;lowercase&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;custom&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tokenizer&quot;</span> <span class="p">:</span> <span class="s2">&quot;seafile_file_name_ngram_tokenizer&quot;</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;tokenizer&quot;</span> <span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;seafile_file_name_ngram_tokenizer&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;ngram&quot;</span><span class="p">,</span>
            <span class="s2">&quot;min_gram&quot;</span> <span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;max_gram&quot;</span> <span class="p">:</span> <span class="s2">&quot;4&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;mappings&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;properties&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;content&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;term_vector&quot;</span> <span class="p">:</span> <span class="s2">&quot;with_positions_offsets&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;filename&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fields&quot;</span> <span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;ngram&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
            <span class="s2">&quot;analyzer&quot;</span> <span class="p">:</span> <span class="s2">&quot;seafile_file_name_ngram_analyzer&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;is_dir&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
        <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="no">false</span>
      <span class="p">},</span>
      <span class="s2">&quot;mtime&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;date&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;path&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;keyword&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;repo&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;keyword&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;long&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;suffix&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;keyword&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span><span class="err">&#39;</span>
</code></pre></div>

<p>Set the <code>refresh_interval</code> to <code>-1</code> and the <code>number_of_replicas</code> to <code>0</code> for efficient reindexing:</p>
<div class="codehilite"><pre><span></span><code>curl <span class="err">-</span>X PUT <span class="err">-</span>H <span class="err">&#39;</span>Content-Type<span class="p">:</span> <span class="l">application/json</span><span class="err">&#39;</span> <span class="err">&#39;</span>http<span class="p">{</span>s<span class="p">}:</span><span class="o">//</span><span class="p">{</span>es server IP<span class="p">}:</span><span class="mi">9200</span><span class="l">/new_repo_head/_settings</span><span class="o">?</span>pretty&#39; <span class="err">-</span>d <span class="err">&#39;</span>
<span class="p">{</span>
  <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;refresh_interval&quot;</span> <span class="p">:</span> <span class="s2">&quot;-1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;number_of_replicas&quot;</span> <span class="p">:</span> <span class="mi">0</span>
  <span class="p">}</span>
<span class="p">}</span><span class="err">&#39;</span>

curl <span class="err">-</span>X PUT <span class="err">-</span>H <span class="err">&#39;</span>Content-Type<span class="p">:</span> <span class="l">application/json</span><span class="err">&#39;</span> <span class="err">&#39;</span>http<span class="p">{</span>s<span class="p">}:</span><span class="o">//</span><span class="p">{</span>es server IP<span class="p">}:</span><span class="mi">9200</span><span class="l">/new_repofiles/_settings</span><span class="o">?</span>pretty&#39; <span class="err">-</span>d <span class="err">&#39;</span>
<span class="p">{</span>
  <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;refresh_interval&quot;</span> <span class="p">:</span> <span class="s2">&quot;-1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;number_of_replicas&quot;</span> <span class="p">:</span> <span class="mi">0</span>
  <span class="p">}</span>
<span class="p">}</span><span class="err">&#39;</span>
</code></pre></div>

<p>Use the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/docs-reindex.html">reindex API</a> to copy documents from the 5.x index into the new index.</p>
<div class="codehilite"><pre><span></span><code>curl <span class="err">-</span>X POST <span class="err">-</span>H <span class="err">&#39;</span>Content-Type<span class="p">:</span> <span class="l">application/json</span><span class="err">&#39;</span> <span class="err">&#39;</span>http<span class="p">{</span>s<span class="p">}:</span><span class="o">//</span><span class="p">{</span>es server IP<span class="p">}:</span><span class="mi">9200</span><span class="l">/_reindex</span><span class="err">/</span><span class="o">?</span>pretty&#39; <span class="err">-</span>d <span class="err">&#39;</span>
<span class="p">{</span>
  <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;repo_head&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;repo_commit&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;new_repo_head&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;_doc&quot;</span>
  <span class="p">}</span>
<span class="p">}</span><span class="err">&#39;</span>

curl <span class="err">-</span>X POST <span class="err">-</span>H <span class="err">&#39;</span>Content-Type<span class="p">:</span> <span class="l">application/json</span><span class="err">&#39;</span> <span class="err">&#39;</span>http<span class="p">{</span>s<span class="p">}:</span><span class="o">//</span><span class="p">{</span>es server IP<span class="p">}:</span><span class="mi">9200</span><span class="l">/_reindex</span><span class="err">/</span><span class="o">?</span>pretty&#39; <span class="err">-</span>d <span class="err">&#39;</span>
<span class="p">{</span>
  <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;repofiles&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;new_repofiles&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;_doc&quot;</span>
  <span class="p">}</span>
<span class="p">}</span><span class="err">&#39;</span>
</code></pre></div>

<p>Reset the <code>refresh_interval</code> and <code>number_of_replicas</code> to the values used in the old index.</p>
<div class="codehilite"><pre><span></span><code>curl <span class="err">-</span>X PUT <span class="err">-</span>H <span class="err">&#39;</span>Content-Type<span class="p">:</span> <span class="l">application/json</span><span class="err">&#39;</span> <span class="err">&#39;</span>http<span class="p">{</span>s<span class="p">}:</span><span class="o">//</span><span class="p">{</span>es server IP<span class="p">}:</span><span class="mi">9200</span><span class="l">/new_repo_head/_settings</span><span class="o">?</span>pretty&#39; <span class="err">-</span>d <span class="err">&#39;</span>
<span class="p">{</span>
  <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;refresh_interval&quot;</span> <span class="p">:</span> <span class="no">null</span><span class="p">,</span>
    <span class="s2">&quot;number_of_replicas&quot;</span> <span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="p">}</span><span class="err">&#39;</span>

curl <span class="err">-</span>X PUT <span class="err">-</span>H <span class="err">&#39;</span>Content-Type<span class="p">:</span> <span class="l">application/json</span><span class="err">&#39;</span> <span class="err">&#39;</span>http<span class="p">{</span>s<span class="p">}:</span><span class="o">//</span><span class="p">{</span>es server IP<span class="p">}:</span><span class="mi">9200</span><span class="l">/new_repofiles/_settings</span><span class="o">?</span>pretty&#39; <span class="err">-</span>d <span class="err">&#39;</span>
<span class="p">{</span>
  <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;refresh_interval&quot;</span> <span class="p">:</span> <span class="no">null</span><span class="p">,</span>
    <span class="s2">&quot;number_of_replicas&quot;</span> <span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="p">}</span><span class="err">&#39;</span>
</code></pre></div>

<p>Wait for the index status to change to <code>green</code>.</p>
<div class="codehilite"><pre><span></span><code>curl http<span class="p">{</span>s<span class="p">}:</span><span class="o">//</span><span class="p">{</span>es server IP<span class="p">}:</span><span class="mi">9200</span><span class="l">/_cluster/health</span><span class="o">?</span>pretty
</code></pre></div>

<p>Use the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/indices-aliases.html">aliases API</a> delete the old index and add an alias with the old index name to the new index.</p>
<div class="codehilite"><pre><span></span><code>curl <span class="err">-</span>X POST <span class="err">-</span>H <span class="err">&#39;</span>Content-Type<span class="p">:</span> <span class="l">application/json</span><span class="err">&#39;</span> <span class="err">&#39;</span>http<span class="p">{</span>s<span class="p">}:</span><span class="o">//</span><span class="p">{</span>es server IP<span class="p">}:</span><span class="mi">9200</span><span class="l">/_aliases</span><span class="o">?</span>pretty&#39; <span class="err">-</span>d <span class="err">&#39;</span>
<span class="p">{</span>
  <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;remove_index&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;repo_head&quot;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s2">&quot;remove_index&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;repofiles&quot;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s2">&quot;add&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;new_repo_head&quot;</span><span class="p">,</span> <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;repo_head&quot;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s2">&quot;add&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;new_repofiles&quot;</span><span class="p">,</span> <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;repofiles&quot;</span><span class="p">}}</span>
  <span class="p">]</span>
<span class="p">}</span><span class="err">&#39;</span>
</code></pre></div>

<p>After reindex, modify the configuration in Seafile.</p>
<p>Modify seafevents.conf</p>
<div class="codehilite"><pre><span></span><code><span class="k">[INDEX FILES]</span><span class="w"></span>
<span class="na">external_es_server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span><span class="w"></span>
<span class="na">es_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">your server&#39;s IP</span><span class="w"></span>
<span class="na">es_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">9200</span><span class="w"></span>
</code></pre></div>

<p>Restart seafile</p>
<div class="codehilite"><pre><span></span><code>su seafile
cd seafile-server-latest/
./seafile.sh stop &amp;&amp; ./seahub.stop 
./seafile.sh start &amp;&amp; ./seahub.start 
</code></pre></div>

<h4 id="method-three-if-you-are-in-a-cluster-environment">Method three, if you are in a cluster environment<a class="headerlink" href="#method-three-if-you-are-in-a-cluster-environment" title="Permanent link">&para;</a></h4>
<p>Deploy a new ElasticSeach 7.x service, use Seafile 9.0 version to deploy a new backend node, and connect to ElasticSeach 7.x. The background node does not start the Seafile background service, just manually run the command <code>./pro/pro.py search --update</code>, and then upgrade the other nodes to Seafile 9.0 version and use the new ElasticSeach 7.x after the index is created. Then deactivate the old backend node and the old version of ElasticSeach.</p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../upgrade_notes_for_8.0.x/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Upgrade notes for 8.0.x" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Upgrade notes for 8.0.x
            </div>
          </div>
        </a>
      
      
        
        <a href="../../extension/" class="md-footer__link md-footer__link--next" aria-label="Next: Outline" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Outline
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020 seafile
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/haiwen/seafile-admin-docs/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>